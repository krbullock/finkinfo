--- boost_1_35_0/tools/build/v2/tools/darwin.jam	2008-03-15 19:55:28.000000000 +0100
+++ boost_1_35_0_corr/tools/build/v2/tools/darwin.jam	2008-04-26 00:48:12.000000000 +0200
@@ -16,6 +16,8 @@
 import common ;
 import generators ;
 import path : basename ;
+import os ; 
+import option ; 
 
 feature.extend toolset : darwin ;
 import gcc ;
@@ -162,7 +164,7 @@
 flags darwin.link OPTIONS <variant>release : -Wl,-dead_strip -no_dead_strip_inits_and_terms ;
 
 flags darwin.compile OPTIONS <link>shared : -dynamic ;
-flags darwin.compile OPTIONS : -Wno-long-double -no-cpp-precomp  -gdwarf-2  ;
+flags darwin.compile OPTIONS : -no-cpp-precomp  -gdwarf-2  ;
 
 flags darwin.link FRAMEWORK <framework> ;
 
@@ -202,11 +204,16 @@
 rule link.dll
 {
     prepare-framework-path $(<) ;
+    local prefix = [ option.get prefix ] ; 
+    LIB_INSTALL_DIR = [ option.get libdir : $(prefix)/lib ] ;
+    VERSIONINFO_COMP = [ option.get compatibility_version ] ; 
+    VERSIONINFO_CUR = [ option.get current_version ] ; 
+    UNDEFINED = [ option.get undefined ] ;
 }
 
 actions link.dll bind LIBRARIES
 {
-    $(CONFIG_COMMAND) -dynamiclib -install_name "$(<:B)$(<:S)" -L"$(LINKPATH)" -o "$(<)" "$(>)" "$(LIBRARIES)" -l$(FINDLIBS-SA) -l$(FINDLIBS-ST) $(FRAMEWORK_PATH) -framework$(_)$(FRAMEWORK:D=:S=) $(OPTIONS) $(USER_OPTIONS)
+    $(CONFIG_COMMAND) -dynamiclib $(UNDEFINED) -install_name $(<:D=$(LIB_INSTALL_DIR):S=.dylib) -compatibility_version $(VERSIONINFO_COMP) -current_version $(VERSIONINFO_CUR) -L"$(LINKPATH)" -o "$(<)" "$(>)" "$(LIBRARIES)" -l$(FINDLIBS-SA) -l$(FINDLIBS-ST) $(FRAMEWORK_PATH) -framework$(_)$(FRAMEWORK:D=:S=) $(OPTIONS) $(USER_OPTIONS)
 }
 
 # We use libtool instead of ar to support universal binary linking
